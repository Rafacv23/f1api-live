---
import SeasonsNav from "@/components/SeasonsNav.astro";
import Layout from "@/layouts/Layout.astro";
import { f1api } from "@/lib/f1Api";

const { year } = Astro.params;

export async function getStaticPaths(){

    const seasons = await f1api.getSeasons()

    return seasons.championships.map((season) => ({
        params: { year: season.year, },
        props: { year: season.year },
    }))
}


const races = await f1api.getRacesByYear({year: year})

---

<Layout>
    <SeasonsNav/>
    <h1>{year} season info</h1>
    <ul class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 my-8">
        {races.races.map((race) => 
            <li class="rounded p-4 shadow hover:shadow-lg bg-secondary text-primary hover:bg-secondary/90 hover:transition">
                <a class="cursor-pointer" href={`/${year}/${race.round}`}>
                        {race.raceName}
                </a>
            </li>)}
    </ul>
</Layout>